{"ast":null,"code":"var _jsxFileName = \"C:\\\\church_project\\\\church-frontend\\\\src\\\\CalendarView.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useContext } from 'react';\nimport FullCalendar from '@fullcalendar/react';\nimport dayGridPlugin from '@fullcalendar/daygrid';\nimport interactionPlugin from '@fullcalendar/interaction';\nimport api from './api';\nimport BookingModal from './BookingModal';\nimport { SocketContext } from './App';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function CalendarView({\n  addNotification\n}) {\n  _s();\n  const [events, setEvents] = useState([]);\n  const [dateMap, setDateMap] = useState({});\n  const [selectedDate, setSelectedDate] = useState(null);\n  const socket = useContext(SocketContext);\n  const fetchBookings = async () => {\n    try {\n      const res = await api.bookings.list();\n      const ev = res.data.map(b => ({\n        id: b.id,\n        title: `${b.service_type} â€” ${b.user_name}`,\n        start: `${b.date}T${b.time_slot.split('-')[0]}`\n      }));\n      setEvents(ev);\n    } catch (e) {\n      console.error(e);\n    }\n  };\n  const fetchCalendar = async () => {\n    try {\n      const res = await api.calendar.get();\n      setDateMap(res.data || {});\n    } catch (e) {\n      console.error(e);\n    }\n  };\n  useEffect(() => {\n    fetchBookings();\n    fetchCalendar();\n    socket.on('new_booking', () => {\n      fetchBookings();\n      fetchCalendar();\n    });\n    socket.on('booking_deleted', () => {\n      fetchBookings();\n      fetchCalendar();\n    });\n    socket.on('calendar_config_updated', () => fetchCalendar());\n    return () => {\n      socket.off('new_booking');\n      socket.off('booking_deleted');\n      socket.off('calendar_config_updated');\n    };\n  }, []);\n  const handleDateClick = arg => setSelectedDate(arg.dateStr);\n  const bgEvents = Object.entries(dateMap).map(([date, info]) => {\n    const status = info.booked >= info.max_slots ? 'red' : 'green';\n    return {\n      id: `bg-${date}`,\n      start: date,\n      display: 'background',\n      allDay: true,\n      backgroundColor: status === 'red' ? 'rgba(255,0,0,0.3)' : 'rgba(0,200,0,0.18)'\n    };\n  });\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      background: 'white',\n      padding: '24px',\n      borderRadius: '12px',\n      boxShadow: '0 2px 8px rgba(0,0,0,0.05)',\n      marginBottom: '24px'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      style: {\n        marginTop: 0,\n        marginBottom: '16px'\n      },\n      children: \"\\uD83D\\uDCC6 Calendar\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(FullCalendar, {\n      plugins: [dayGridPlugin, interactionPlugin],\n      initialView: \"dayGridMonth\",\n      height: \"auto\",\n      events: [...events, ...bgEvents],\n      dateClick: handleDateClick\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: '20px',\n        padding: '16px',\n        background: '#f7fafc',\n        borderRadius: '8px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          fontWeight: 600,\n          marginBottom: '12px',\n          color: '#2d3748'\n        },\n        children: \"\\uD83D\\uDCCB Legend:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 50,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          gap: '24px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            alignItems: 'center',\n            gap: '8px'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              background: 'rgba(72, 187, 120, 0.2)',\n              padding: '8px 12px',\n              borderRadius: '4px',\n              border: '1px solid rgba(72, 187, 120, 0.3)'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 53,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              fontSize: '14px',\n              color: '#4a5568'\n            },\n            children: \"Available slots\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 54,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 52,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            alignItems: 'center',\n            gap: '8px'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              background: 'rgba(245, 101, 101, 0.2)',\n              padding: '8px 12px',\n              borderRadius: '4px',\n              border: '1px solid rgba(245, 101, 101, 0.3)'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 57,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              fontSize: '14px',\n              color: '#4a5568'\n            },\n            children: \"Fully booked\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 58,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 56,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 51,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 7\n    }, this), selectedDate && /*#__PURE__*/_jsxDEV(BookingModal, {\n      date: selectedDate,\n      onClose: () => setSelectedDate(null),\n      onBooked: () => {\n        addNotification({\n          type: 'info',\n          text: `âœ¨ Successfully booked on ${selectedDate}`\n        });\n        setSelectedDate(null);\n        fetchBookings();\n        fetchCalendar();\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 24\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 46,\n    columnNumber: 5\n  }, this);\n}\n_s(CalendarView, \"euMUcyQfJD8d4gAeuNsY5Yabyrc=\");\n_c = CalendarView;\nvar _c;\n$RefreshReg$(_c, \"CalendarView\");","map":{"version":3,"names":["React","useState","useEffect","useContext","FullCalendar","dayGridPlugin","interactionPlugin","api","BookingModal","SocketContext","jsxDEV","_jsxDEV","CalendarView","addNotification","_s","events","setEvents","dateMap","setDateMap","selectedDate","setSelectedDate","socket","fetchBookings","res","bookings","list","ev","data","map","b","id","title","service_type","user_name","start","date","time_slot","split","e","console","error","fetchCalendar","calendar","get","on","off","handleDateClick","arg","dateStr","bgEvents","Object","entries","info","status","booked","max_slots","display","allDay","backgroundColor","style","background","padding","borderRadius","boxShadow","marginBottom","children","marginTop","fileName","_jsxFileName","lineNumber","columnNumber","plugins","initialView","height","dateClick","fontWeight","color","gap","alignItems","border","fontSize","onClose","onBooked","type","text","_c","$RefreshReg$"],"sources":["C:/church_project/church-frontend/src/CalendarView.js"],"sourcesContent":["import React, { useState, useEffect, useContext } from 'react';\nimport FullCalendar from '@fullcalendar/react';\nimport dayGridPlugin from '@fullcalendar/daygrid';\nimport interactionPlugin from '@fullcalendar/interaction';\nimport api from './api';\nimport BookingModal from './BookingModal';\nimport { SocketContext } from './App';\n\nexport default function CalendarView({ addNotification }){\n  const [events, setEvents] = useState([]);\n  const [dateMap, setDateMap] = useState({});\n  const [selectedDate, setSelectedDate] = useState(null);\n  const socket = useContext(SocketContext);\n\n  const fetchBookings = async () => {\n    try {\n      const res = await api.bookings.list();\n      const ev = res.data.map(b => ({ id:b.id, title:`${b.service_type} â€” ${b.user_name}`, start:`${b.date}T${b.time_slot.split('-')[0]}` }));\n      setEvents(ev);\n    } catch(e){ console.error(e); }\n  }\n\n  const fetchCalendar = async () => {\n    try {\n      const res = await api.calendar.get();\n      setDateMap(res.data || {});\n    } catch(e){ console.error(e); }\n  }\n\n  useEffect(()=> {\n    fetchBookings(); fetchCalendar();\n    socket.on('new_booking', ()=>{ fetchBookings(); fetchCalendar(); });\n    socket.on('booking_deleted', ()=>{ fetchBookings(); fetchCalendar(); });\n    socket.on('calendar_config_updated', ()=> fetchCalendar());\n    return ()=> { socket.off('new_booking'); socket.off('booking_deleted'); socket.off('calendar_config_updated'); }\n  },[]);\n\n  const handleDateClick = (arg) => setSelectedDate(arg.dateStr);\n\n  const bgEvents = Object.entries(dateMap).map(([date, info]) => {\n    const status = (info.booked >= info.max_slots) ? 'red' : 'green';\n    return { id:`bg-${date}`, start: date, display:'background', allDay:true, backgroundColor: status==='red' ? 'rgba(255,0,0,0.3)' : 'rgba(0,200,0,0.18)' }\n  });\n\n  return (\n    <div style={{ background:'white', padding:'24px', borderRadius:'12px', boxShadow:'0 2px 8px rgba(0,0,0,0.05)', marginBottom:'24px' }}>\n      <h2 style={{ marginTop:0, marginBottom:'16px' }}>ðŸ“† Calendar</h2>\n      <FullCalendar plugins={[dayGridPlugin, interactionPlugin]} initialView=\"dayGridMonth\" height=\"auto\" events={[...events,...bgEvents]} dateClick={handleDateClick} />\n      <div style={{ marginTop:'20px', padding:'16px', background:'#f7fafc', borderRadius:'8px' }}>\n        <div style={{ fontWeight:600, marginBottom:'12px', color:'#2d3748' }}>ðŸ“‹ Legend:</div>\n        <div style={{ display:'flex', gap:'24px' }}>\n          <div style={{ display:'flex', alignItems:'center', gap:'8px' }}>\n            <span style={{ background:'rgba(72, 187, 120, 0.2)', padding:'8px 12px', borderRadius:'4px', border:'1px solid rgba(72, 187, 120, 0.3)' }}></span>\n            <span style={{ fontSize:'14px', color:'#4a5568' }}>Available slots</span>\n          </div>\n          <div style={{ display:'flex', alignItems:'center', gap:'8px' }}>\n            <span style={{ background:'rgba(245, 101, 101, 0.2)', padding:'8px 12px', borderRadius:'4px', border:'1px solid rgba(245, 101, 101, 0.3)' }}></span>\n            <span style={{ fontSize:'14px', color:'#4a5568' }}>Fully booked</span>\n          </div>\n        </div>\n      </div>\n      {selectedDate && <BookingModal date={selectedDate} onClose={()=>setSelectedDate(null)} onBooked={()=>{ addNotification({ type:'info', text:`âœ¨ Successfully booked on ${selectedDate}`}); setSelectedDate(null); fetchBookings(); fetchCalendar(); }} />}\n    </div>\n  )\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}